[tox]
# TODO: Fix py37. I think Nix is confusing Tox, but I can't prove it.
# I get this error:
# could not install deps [pytest, typing_extensions, dask[bag]]; v = InvocationError("/home/sam/box/charmonium.cache/.tox/py37/bin/python -m pip install pytest typing_extensions 'dask[bag]'", 1)
envlist = py{38,39}
isolated_build = True

[tox:.package]
# note tox will use the same python version as under what tox is installed to package
# so unless this is python 3 you can require a given python version for the packaging
# environment via the basepython key
basepython = python3

[testenv]
passenv =
    PYTHONPATH
deps =
    # Only install those dev dependencies I use in the actual tests
    pytest
    typing_extensions
	dask[bag]
allowlist_externals=
    /*/rm
    /*/test
commands =
    rm -rf .cache
    pytest --quiet --exitfirst
